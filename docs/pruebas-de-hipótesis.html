<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Pruebas de Hipótesis | Curso de R</title>
  <meta name="description" content="5 Pruebas de Hipótesis | Curso de R" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Pruebas de Hipótesis | Curso de R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Pruebas de Hipótesis | Curso de R" />
  
  
  

<meta name="author" content="Juan R González" />


<meta name="date" content="2021-01-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estadística-descriptiva.html"/>
<link rel="next" href="modelos-de-regresión.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Aprendizaje Automático 1</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="importar.html"><a href="importar.html"><i class="fa fa-check"></i><b>2</b> Importar datos a R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="importar.html"><a href="importar.html#directorio-de-trabajo"><i class="fa fa-check"></i><b>2.1</b> Directorio de trabajo</a></li>
<li class="chapter" data-level="2.2" data-path="importar.html"><a href="importar.html#importar-datos-de-texto"><i class="fa fa-check"></i><b>2.2</b> Importar datos de texto</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manejo de datos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#visualización-de-datos"><i class="fa fa-check"></i><b>3.1</b> Visualización de datos</a></li>
<li class="chapter" data-level="3.2" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#creación-de-variables"><i class="fa fa-check"></i><b>3.2</b> Creación de variables</a></li>
<li class="chapter" data-level="3.3" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#recodificación-de-variables"><i class="fa fa-check"></i><b>3.3</b> Recodificación de variables</a></li>
<li class="chapter" data-level="3.4" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#filtrado-de-datos"><i class="fa fa-check"></i><b>3.4</b> Filtrado de datos</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html"><i class="fa fa-check"></i><b>4</b> Estadística descriptiva</a>
<ul>
<li class="chapter" data-level="4.1" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#variables-categóricas"><i class="fa fa-check"></i><b>4.1</b> Variables categóricas</a></li>
<li class="chapter" data-level="4.2" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#tabla-de-contingencia"><i class="fa fa-check"></i><b>4.2</b> Tabla de contingencia</a></li>
<li class="chapter" data-level="4.3" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#variables-continuas"><i class="fa fa-check"></i><b>4.3</b> Variables continuas</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html"><i class="fa fa-check"></i><b>5</b> Pruebas de Hipótesis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-hipótesis-para-la-media-mu-de-una-población-normal"><i class="fa fa-check"></i><b>5.1</b> Prueba de hipótesis para la media, <span class="math inline">\(\mu\)</span>, de una población normal</a>
<ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-hipótesis-para-la-proporción-p-de-una-población"><i class="fa fa-check"></i><b>5.2</b> Prueba de hipótesis para la proporción <span class="math inline">\(p\)</span> de una población</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-wald"><i class="fa fa-check"></i><b>5.2.1</b> Prueba de Wald</a></li>
<li class="chapter" data-level="5.2.2" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-chi2-de-pearson"><i class="fa fa-check"></i><b>5.2.2</b> Prueba <span class="math inline">\(\chi^2\)</span> de Pearson</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="5.2.3" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-binomial-exacta"><i class="fa fa-check"></i><b>5.2.3</b> Prueba binomial exacta</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-hipótesis-para-la-razón-de-varianzas-sigma_12-sigma_22"><i class="fa fa-check"></i><b>5.3</b> Prueba de hipótesis para la razón de varianzas <span class="math inline">\(\sigma_1^2 / \sigma_2^2\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-hipótesis-para-la-igualdad-de-medias-mu_a-mu_b"><i class="fa fa-check"></i><b>5.4</b> Prueba de hipótesis para la igualdad de medias <span class="math inline">\(\mu_A = \mu_B\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-hipótesis-para-la-igualdad-de-más-de-dos-medias-anova"><i class="fa fa-check"></i><b>5.5</b> Prueba de hipótesis para la igualdad de más de dos medias (ANOVA)</a>
<ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-hipótesis-para-la-igualdad-de-proporciones-p_a-p_b"><i class="fa fa-check"></i><b>5.6</b> Prueba de hipótesis para la igualdad de proporciones <span class="math inline">\(p_A = p_B\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#pruebas-no-paramétricas"><i class="fa fa-check"></i><b>5.7</b> Pruebas no paramétricas</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html"><i class="fa fa-check"></i><b>6</b> Modelos de regresión</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#regresión-lineal"><i class="fa fa-check"></i><b>6.1</b> Regresión lineal</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#modelo-lineal-simple"><i class="fa fa-check"></i><b>6.1.1</b> Modelo lineal simple</a></li>
<li class="chapter" data-level="6.1.2" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#regresión-lineal-multivariante"><i class="fa fa-check"></i><b>6.1.2</b> Regresión lineal multivariante</a></li>
<li class="chapter" data-level="6.1.3" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#ajuste-de-un-modelo-lineal"><i class="fa fa-check"></i><b>6.1.3</b> Ajuste de un modelo lineal</a></li>
<li class="chapter" data-level="6.1.4" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#interpretación-de-coeficientes"><i class="fa fa-check"></i><b>6.1.4</b> Interpretación de coeficientes</a></li>
<li class="chapter" data-level="6.1.5" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#inferencia-en-el-contexto-de-regresión"><i class="fa fa-check"></i><b>6.1.5</b> Inferencia en el contexto de regresión</a></li>
<li class="chapter" data-level="6.1.6" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#asunciones-de-un-modelo-de-regresión"><i class="fa fa-check"></i><b>6.1.6</b> Asunciones de un modelo de regresión</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#regresión-logística"><i class="fa fa-check"></i><b>6.2</b> Regresión logística</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#interpretación-de-los-coeficientes"><i class="fa fa-check"></i><b>6.2.1</b> Interpretación de los coeficientes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#creación-de-modelos"><i class="fa fa-check"></i><b>6.3</b> Creación de modelos</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#selección-paso-a-paso-stepwise"><i class="fa fa-check"></i><b>6.3.1</b> Selección paso a paso (stepwise)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="gráficos.html"><a href="gráficos.html"><i class="fa fa-check"></i><b>7</b> Gráficos</a>
<ul>
<li class="chapter" data-level="7.1" data-path="gráficos.html"><a href="gráficos.html#gráficos-para-una-variable-cuantitativa"><i class="fa fa-check"></i><b>7.1</b> Gráficos para una variable cuantitativa</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="gráficos.html"><a href="gráficos.html#función-stem"><i class="fa fa-check"></i><b>7.1.1</b> Función <code>stem ()</code></a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="7.1.2" data-path="gráficos.html"><a href="gráficos.html#función-boxplot"><i class="fa fa-check"></i><b>7.1.2</b> Función <code>boxplot ()</code></a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo 1</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo 2</a></li>
<li class="chapter" data-level="7.1.3" data-path="gráficos.html"><a href="gráficos.html#función-hist"><i class="fa fa-check"></i><b>7.1.3</b> Función <code>hist ()</code></a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="7.1.4" data-path="gráficos.html"><a href="gráficos.html#función-density"><i class="fa fa-check"></i><b>7.1.4</b> Función <code>density ()</code></a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="gráficos.html"><a href="gráficos.html#gráficos-para-dos-variables-cuantitativas"><i class="fa fa-check"></i><b>7.2</b> Gráficos para dos variables cuantitativas</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="gráficos.html"><a href="gráficos.html#función-plot"><i class="fa fa-check"></i><b>7.2.1</b> Función <code>plot ()</code></a></li>
<li class="chapter" data-level="" data-path="gráficos.html"><a href="gráficos.html#ejemplos"><i class="fa fa-check"></i>Ejemplos</a></li>
<li class="chapter" data-level="7.2.2" data-path="gráficos.html"><a href="gráficos.html#función-pairs"><i class="fa fa-check"></i><b>7.2.2</b> Función <code>pairs ()</code></a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="gráficos.html"><a href="gráficos.html#gráficos-para-variables-categóricas"><i class="fa fa-check"></i><b>7.3</b> Gráficos para variables categóricas</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="gráficos.html"><a href="gráficos.html#función-barplot"><i class="fa fa-check"></i><b>7.3.1</b> Función <code>barplot ()</code></a></li>
<li class="chapter" data-level="" data-path="gráficos.html"><a href="gráficos.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="gráficos.html"><a href="gráficos.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="7.3.2" data-path="gráficos.html"><a href="gráficos.html#la-función-pie"><i class="fa fa-check"></i><b>7.3.2</b> La función <code>pie ()</code></a></li>
<li class="chapter" data-level="" data-path="gráficos.html"><a href="gráficos.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="7.3.3" data-path="gráficos.html"><a href="gráficos.html#función-dotchart"><i class="fa fa-check"></i><b>7.3.3</b> Función <code>dotchart ()</code></a></li>
<li class="chapter" data-level="" data-path="gráficos.html"><a href="gráficos.html#ejemplo-9"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="gráficos.html"><a href="gráficos.html#la-librería-lattice"><i class="fa fa-check"></i><b>7.4</b> La librería <code>lattice</code></a>
<ul>
<li class="chapter" data-level="" data-path="gráficos.html"><a href="gráficos.html#ejemplos-1"><i class="fa fa-check"></i>Ejemplos</a></li>
<li class="chapter" data-level="" data-path="gráficos.html"><a href="gráficos.html#ejemplos-2"><i class="fa fa-check"></i>Ejemplos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Curso de R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pruebas-de-hipótesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Pruebas de Hipótesis</h1>
<p>En la siguiente figura podemos observar un esquema general de cómo abordar un problema científico desde un punto de vista estadístico. Partimos de una pregunta científica que nos planteamos sobre nuestra población de estudio. Esta pregunta debe ser <em>traducida</em> a una pregunta estadística que nos permita saber cómo abordarla desde un punto de vista matemático o estadístico.</p>
<div class="figure">
<img src="figures/schemeStatistics.jpg" style="height:12cm" alt="" />
<p class="caption">Esquema investigación científica</p>
</div>
<p>Por ejemplo, imaginemos que estamos interesados en saber si el consumo de aspirina reduce el riesgo de sufrir un infarto de miocardio. Hay un método muy sencillo de saber qué problema necesitamos abordar desde un punto de vista estadístico a partir de nuestra pregunta científica y es conocer la naturaleza de nuestros datos. En este caso, nuestra variable resultado sería sufrir o no un infarto, por lo que estaríamos ante una variable binaria. Este tipo de variables se resumen con la frecuencia relativa o proporciones. De esta forma, la pregunta estadística se traduciría cómo: ¿La proporción de personas que sufren un infarto es igual en aquellas personas que toman aspirina que en las que no toma?</p>
<p>Para contestar a esta pregunta, el método científico nos indica que debemos tomar una muestra aleatoria (para garantizar representatividad de nuestra problación) que describiremos con métodos descriptivos vistos en el tema anterior. También podemos realizar un experimento o diseñar un estudio que nos permita contestar a nuestra pregunta cienífica. Existen muchos tipos de diseños, que se suponen que son familiares para el alumno.</p>
<p>Para nuestro ejemplo podríamos, entre otras opciones, diseñar un estudio en el que estudiáramos personas que han sufrido un infarto y otro grupo control de la misma edad y sexo a los que preguntaríamos si han tomado o no aspirina durante los últimos años (diseño caso-control). Entonces, podríamos compararla proporción de infartos entre las personas que toman y no toman aspirina. Empezaríamos por mostrar estas diferencias de forma visual con, por ejemplo, un gráfico de barras (que es como se visualizan las variables categóricas). Ahora nuestra siguiente pregunta sería saber si las diferencias que observamos son reales o son debidas al azar (es decir, por no estudiar toda la población y si una muestra aleatoria). Para demostrar que estas diferencias son reales (e.g estadísticamente significativas) debemos realizar lo que se conoce como inferencia estadística, que en este caso correspondería a una prueba de hipótesis.</p>
<p>En el caso que nuestra pregunta científica esté asociada a una variable continua se abordaría de la misma forma. La única diferencia es que la prueba de hipótesis planteada sería distinta. Por ejemplo, supongamos que queremos saber si el consumo de café aumenta la tensión arterial. En ese caso, nuestra variable resultado es tensión arterial, que al ser continua se resume con la media. Así pues, nuestra pregunta estadística sería: ¿La media de tensión arterial es igual en los consumidores de café que en los que no consumen?</p>
<p>En consecuencia, las pruebas que nos planteamos para comparar ambos grupos (A y B) en cada ejemplo sería</p>
<p><span class="math display">\[H_0: p_A = p_B\]</span></p>
<p>y</p>
<p><span class="math display">\[H_0: \bar{x}_A = \bar{x}_B\]</span></p>
<p>respectivamente.</p>
<p>Una vez planteadas las pruebas de hipótesis, basta con usar un software estadístico para calcular el <strong>p-valor</strong> que es la medida que nos indica si las diferencias observadas en nuestra muestra son reales o son debidas al azar. En otras palabras, demostramos si las diferencias observadas son <strong>estadísticamente significativas</strong>. Como decimos, el proceso para determinar esta significación estadística se basa en el cálculo del p-valor, y consideraremos que las diferencias serán estadísticamente significativas si el p-valor<span class="math inline">\(&lt;0.05\)</span> y no cuando ocurra lo contrario.</p>
<p>A este valor de <span class="math inline">\(0.05\)</span> se le conoce como el nivel de significación estadística (<span class="math inline">\(\alpha\)</span>) y es el valor que asumimos como riesgo a equivocarnos cuando las diferencias no son reales. En la siguiente figura podemos ver un resumen del tipo de errores que podemos cometer cuando llevamos a cabo una prueba de hipótesis</p>
<p><img src="figures/errores.png" style="height:8cm" alt="Tipos de errores en una prueba de hipótesis" />
A modo de resumen podríamos decir que los pasos en un proceso de investigación serían:</p>
<ul>
<li>Formular hipotesis nula (y alternativa)</li>
<li>Decidir el nivel de significanza estadística (<span class="math inline">\(\alpha\)</span>)</li>
<li>Eligir un test estadístico a utilizarse (que dependerá del tipo de variable que estudiemos)</li>
<li>Calcular el p-valor con ese test y decidir si rechazamos <span class="math inline">\(H_0\)</span> o no.</li>
</ul>
<p>Para entender un poco mejor este procedimiento, podems compararlo con el simil de un jurado. Es importante notar que siempre partimos de la hipótesis nula y que queremos dar evidencias a partir de nuestros datos, nunca hacemos lo contrario, al igual que pasa en un juicio</p>
<div class="figure">
<img src="figures/simil_jurado.png" style="height:8cm" alt="" />
<p class="caption">Símil del jurado en pruebas de hipótesis</p>
</div>
<p>A continuación explicaremos cómo llevar a cabo estas pruebas de hipótesis con R en función de nuestra variable de interés para las siguientes pruebas.</p>
<p>En este capítulo se muestran las funciones que hay disponibles en R para realizar prueba de hipótesis para:</p>
<ol style="list-style-type: decimal">
<li>La media <span class="math inline">\(\mu\)</span>,</li>
<li>La proporción <span class="math inline">\(p\)</span>,</li>
<li>La razón de varianzas <span class="math inline">\(\sigma_A^2 / \sigma_B^2\)</span>,</li>
<li>La igualdad de medias <span class="math inline">\(\mu_A = \mu_B\)</span> para muestras independientes,</li>
<li>La igualdad de medias para más de dos grupos (ANOVA), y</li>
<li>La igualdad de proporciones <span class="math inline">\(p_A = p_B\)</span>.</li>
<li>Pruebas no-paramétricas</li>
</ol>
<p>Para ilustrar estos cálculos usaremos la base de datos <code>multicentric.txt</code> que hemos trabajado en capítulos anteriores. Para ello, recordemos que primero debemos cargar los datos en R tal y como se ha descrito en el capítulo @ref{importar}, o bien con el menú o bien con la siguiente instrucción.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="pruebas-de-hipótesis.html#cb64-1"></a>multicentric &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;datos/multicentric.txt&quot;</span>)</span></code></pre></div>
<p>NOTA: recordad que para que esta instrucción funcione debéis cambiar el directorio de trabajo a la carpeta que contenga este fichero.</p>
<div id="prueba-de-hipótesis-para-la-media-mu-de-una-población-normal" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Prueba de hipótesis para la media, <span class="math inline">\(\mu\)</span>, de una población normal</h2>
<p>Este test se llevará a cabo cuando nuestra pregunta científica se interese por una variable resultado de tipo continua. Para realizar este tipo de prueba se puede usar la función <code>t.test</code> que tiene la siguiente estructura.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="pruebas-de-hipótesis.html#cb65-1"></a><span class="kw">t.test</span>(x, <span class="dt">y =</span> <span class="ot">NULL</span>,</span>
<span id="cb65-2"><a href="pruebas-de-hipótesis.html#cb65-2"></a>       <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;greater&quot;</span>),</span>
<span id="cb65-3"><a href="pruebas-de-hipótesis.html#cb65-3"></a>       <span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">paired =</span> <span class="ot">FALSE</span>, <span class="dt">var.equal =</span> <span class="ot">FALSE</span>,</span>
<span id="cb65-4"><a href="pruebas-de-hipótesis.html#cb65-4"></a>       <span class="dt">conf.level =</span> <span class="fl">0.95</span>, ...)</span></code></pre></div>
<p>Los argumentos a definir dentro de <code>t.test</code> para hacer la prueba son:</p>
<ul>
<li><code>x</code>: vector numérico con los datos.</li>
<li><code>alternative</code>: tipo de hipótesis alterna. Los valores disponibles son <code>"two.sided"</code> cuando la hipótesis alterna es <span class="math inline">\(\neq\)</span>, <code>"less"</code> para el caso <span class="math inline">\(&lt;\)</span> y <code>"greater"</code> para <span class="math inline">\(&gt;\)</span>.</li>
<li><code>mu</code>: valor de referencia de la prueba.</li>
<li><code>conf.level</code>: nivel de confianza para reportar el intervalo de confianza asociado (opcional).</li>
</ul>
<div id="ejemplo" class="section level3 unnumbered" number="">
<h3>Ejemplo</h3>
<p>Supongamos que queremos saber si la edad de la primera relación sexual es superior a los 18 años. Lo primero que debemos hacer es comprobar si los datos siguene una distribución normal. Para ello usaremos una libería que tiene una batería de 10 pruebas distintas que se llama <code>nortest</code>. Para usarla, primero hay que instalarla</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="pruebas-de-hipótesis.html#cb66-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;nortest&quot;</span>)</span></code></pre></div>
<p>y luego podemos evaluar si la variable es normal usando cualquiera de los tests implementados, de la siguiente forma</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="pruebas-de-hipótesis.html#cb67-1"></a><span class="kw">library</span>(nortest)   </span>
<span id="cb67-2"><a href="pruebas-de-hipótesis.html#cb67-2"></a><span class="kw">lillie.test</span>(multicentric<span class="op">$</span>edad1sex)</span></code></pre></div>
<pre><code>
	Lilliefors (Kolmogorov-Smirnov) normality test

data:  multicentric$edad1sex
D = 0.12136, p-value &lt; 2.2e-16</code></pre>
<p>Nosotros hemos usado la prueba de Lilliefors (Kolmogorov-Smirnov) pero se pueden usar otras como la de Anderson-Darling (función <code>ad.test</code>) o Shapiro-Francia (función <code>sf.test</code>) entre muchas otras.</p>
<p>Podemos ver que rechazamos la hipóteisis nula de normalidad ($p&lt;0.05), por lo que necesitmos solventar este problema. Normalmente esto se hace transformando los datos usando la transformación logarítmica. Luego volvemos a testar la normalidad para ver si podemos aplicar el test para la media. Para ello crearemos primero una nueva variable que llamaremos <code>edad1sex2</code>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="pruebas-de-hipótesis.html#cb69-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb69-2"><a href="pruebas-de-hipótesis.html#cb69-2"></a>multicentric &lt;-<span class="st"> </span><span class="kw">mutate</span>(multicentric, <span class="dt">edad1sex2 =</span> <span class="kw">log</span>(edad1sex))</span></code></pre></div>
<p>y ahora aplicamos el test a la nueva variable</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="pruebas-de-hipótesis.html#cb70-1"></a><span class="kw">lillie.test</span>(multicentric<span class="op">$</span>edad1sex2)</span></code></pre></div>
<pre><code>
	Lilliefors (Kolmogorov-Smirnov) normality test

data:  multicentric$edad1sex2
D = 0.088069, p-value &lt; 2.2e-16</code></pre>
<p>Vemos que la variable sigue sin ser normal. También podríamos verlo de forma gráfica</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="pruebas-de-hipótesis.html#cb72-1"></a><span class="kw">hist</span>(multicentric<span class="op">$</span>edad1sex2, <span class="dt">xlab=</span><span class="st">&quot;log(edad primera relación sexual)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="fig/unnamed-chunk-148-1.png" width="672" /></p>
<p>Observamos que la cola de la izquierda es más pesada que la de la derecha. Es decir, la distribución sigue sin ser simétrica que es una de las características principales de las variables normales. Ahora tenemos dos opciones:</p>
<ul>
<li><p>Buscar otro tipo de transformación que garantice la normalidad</p></li>
<li><p>Usar un test no paramétrico.</p></li>
</ul>
<p>La segunda opción la veremos en capítulos más adelante y es la que recomendamos realizar ya que la primera opción tiene sus inconvenientes, sobre todo si queremos interpretar los resultados ya que la transformación a aplicar (<a href="https://en.wikipedia.org/wiki/Power_transform">Yeo-Johnson</a>) puedes tener una forma muy complicada. Si alguien quiere hacer esta transformación en R existen varias librerías que pueden hacer esta transformación como la libería <a href="https://cran.r-project.org/web/packages/bestNormalize/bestNormalize.pdf">bestNormalize</a>. En este trabajo asumiremos que la variable <code>edad1sex</code> es normal e ilustraremos como realizar el test que estabamos interesados:</p>
<p><span class="math display">\[H_0: \text{edad1sex = 18}\]</span>
<span class="math display">\[H_1: \text{edad1sex &gt; 18}\]</span></p>
<p>Esta prueba de hipótesis se puede realizar usando la función <code>t.test</code> por medio del siguiente código.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="pruebas-de-hipótesis.html#cb73-1"></a><span class="kw">t.test</span>(multicentric<span class="op">$</span>edad1sex, </span>
<span id="cb73-2"><a href="pruebas-de-hipótesis.html#cb73-2"></a>       <span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>, <span class="dt">mu=</span><span class="dv">18</span>)</span></code></pre></div>
<pre><code>
	One Sample t-test

data:  multicentric$edad1sex
t = 19.639, df = 2888, p-value &lt; 2.2e-16
alternative hypothesis: true mean is greater than 18
95 percent confidence interval:
 19.58443      Inf
sample estimates:
mean of x 
 19.72932 </code></pre>
<p>Como el valor-P es &lt;0.05 y por lo tanto menor que el nivel de significanción del 5%, tenemos evidencias para rechazar la hipótesis nula, es decir, las evidencias son suficientes para afirmar que la edad de la primera relación sexual no ocurre a los 18 años. NOTA: no es habitual hacer test unilaterales (alternativa mayor o menor) ya que está recomendado hacer bi-laterales (el valor por defecto del argumento <code>alternative</code>) pero hemos querido hacer este ejemplo para ilustrar como plantear este tipo de pruevas de hipótesis.</p>
</div>
</div>
<div id="prueba-de-hipótesis-para-la-proporción-p-de-una-población" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Prueba de hipótesis para la proporción <span class="math inline">\(p\)</span> de una población</h2>
<p>Este test se llevará a cabo cuando nuestra pregunta científica se interese por una variable resultado binaria o categórica.</p>
<p>Existen varias pruebas para testar si la propoción <span class="math inline">\(p\)</span> de una distribución binomial (porque tenemos <span class="math inline">\(n\)</span> individuos que siguen una Bernoulli de parámetro <span class="math inline">\(p\)</span>) sigue un valor predeterminado.</p>
<ol style="list-style-type: decimal">
<li>Prueba de <a href="https://en.wikipedia.org/wiki/Wald_test">Wald</a>,</li>
<li>Prueba <span class="math inline">\(\chi^2\)</span> de <a href="https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test#Fairness_of_dice">Pearson</a>,</li>
<li>Prueba <a href="https://en.wikipedia.org/wiki/Binomial_test">binomial exacta</a>.</li>
</ol>
<div id="prueba-de-wald" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Prueba de Wald</h3>
<p>Esta prueba se recomienda usar cuando se tiene un tamaño de muestra <span class="math inline">\(n\)</span> suficientemente grande para poder usar la distribución normal como aproximación de la distribución binomial.</p>
<p>En esta prueba el estadístico está dado por</p>
<p><span class="math display">\[z=\frac{\hat{p}-p_0}{\sqrt{\frac{p_0(1-p_0)}{n}}},\]</span>
donde <span class="math inline">\(\hat{p}\)</span> es la proporción muestral calculada como el cociente entre el número de éxitos <span class="math inline">\(x\)</span> observados en los <span class="math inline">\(n\)</span> ensayos y <span class="math inline">\(p_0\)</span> es el valor de referencia de las hipótesis. El estadístico <span class="math inline">\(z\)</span> tiene distribución <span class="math inline">\(N(0, 1)\)</span> cuando <span class="math inline">\(n \to \infty\)</span>.</p>
<p>Para realizar esta prueba en R no hay una función y debemos escribir la líneas de código para obtener el estadístico y el valor-P de la prueba. Dado que estamos en un curso introductorio, obviaremos esta solución que aunque no es compleja, requiere escribir algo de código en R y no usar una función</p>
</div>
<div id="prueba-chi2-de-pearson" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Prueba <span class="math inline">\(\chi^2\)</span> de Pearson</h3>
<p>Esta prueba también require de un tamaño muestral <span class="math inline">\(n\)</span> grande. Para realizar los cálculos se usa la función <code>prop.test</code> que tiene la siguiente estructura.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="pruebas-de-hipótesis.html#cb75-1"></a><span class="kw">prop.test</span>(x, n, <span class="dt">p =</span> <span class="ot">NULL</span>,</span>
<span id="cb75-2"><a href="pruebas-de-hipótesis.html#cb75-2"></a>          <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;greater&quot;</span>),</span>
<span id="cb75-3"><a href="pruebas-de-hipótesis.html#cb75-3"></a>          <span class="dt">conf.level =</span> <span class="fl">0.95</span>, <span class="dt">correct =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Los argumentos a definir dentro de <code>prop.test</code> para hacer la prueba son:</p>
<ul>
<li><code>x</code>: número de éxitos en la muestra.</li>
<li><code>n</code>: número de observaciones en la muestra.</li>
<li><code>alternative</code>: tipo de hipótesis alterna. Los valores disponibles son <code>"two.sided"</code> cuando la alterna es <span class="math inline">\(\neq\)</span>, <code>"less"</code> para el caso <span class="math inline">\(&lt;\)</span> y <code>"greater"</code> para <span class="math inline">\(&gt;\)</span>.</li>
<li><code>p</code>: valor de referencia de la prueba.</li>
<li><code>correct</code>: valor lógico para indicar si se usa la corrección de Yates.</li>
<li><code>conf.level</code>: nivel de confianza para reportar el intervalo de confianza asociado (opcional).</li>
</ul>
</div>
<div id="ejemplo-1" class="section level3 unnumbered" number="">
<h3>Ejemplo</h3>
<p>Supongamos que queremos saber si en nuestro estudio de cáncer cervical, la proporción de gente que se realiza una prueba del virus de papiloma humano (variable <code>pap</code>) es del 55% ya que ese es el porcentaje de pruebas que se realiza en España y lo consideramos como el de referencia.</p>
<p>En este problema interesa probar lo siguiente:</p>
<p><span class="math display">\[H_0: p = 0.55\]</span>
<span class="math display">\[H_1: p \ne 0.55\]</span>
La forma de usar la función <code>prop.test</code> para realizar la prueba se muestra a continuación.</p>
<p>Primero necesitamos saber cuántas mujeres se hacen o no la prueba del virus de papiloma humano y cuántas mujeres tenemos en total. Esto lo podemos saber con:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="pruebas-de-hipótesis.html#cb76-1"></a><span class="kw">nrow</span>(multicentric)</span></code></pre></div>
<pre><code>[1] 2910</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="pruebas-de-hipótesis.html#cb78-1"></a><span class="kw">table</span>(multicentric<span class="op">$</span>pap)</span></code></pre></div>
<pre><code>
  no   si 
1291 1575 </code></pre>
<p>Entonces usamos la función como</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="pruebas-de-hipótesis.html#cb80-1"></a><span class="kw">prop.test</span>(<span class="dt">x=</span><span class="dv">1575</span>, <span class="dt">n=</span><span class="dv">2910</span>, <span class="dt">p=</span><span class="fl">0.55</span>)</span></code></pre></div>
<pre><code>
	1-sample proportions test with continuity correction

data:  1575 out of 2910, null probability 0.55
X-squared = 0.86778, df = 1, p-value = 0.3516
alternative hypothesis: true p is not equal to 0.55
95 percent confidence interval:
 0.5229179 0.5594466
sample estimates:
        p 
0.5412371 </code></pre>
<p>Como el p-valor es &gt;0.05, concluimos que no tenemos evidencias para afirmar que el porcentaje de mujeres que se hacen la prueba del virus de papiloma humano sea distinta a la de España (0.55). NOTA: nunca aceptamos la hipótesis nula y decimos que nuestra proporción es del 55%.</p>
</div>
<div id="prueba-binomial-exacta" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Prueba binomial exacta</h3>
<p>Esta prueba se recomienda cuando tenemos un tamaño muestral <span class="math inline">\(n\)</span> muy pequeño (menor de 30). Para realizar la prueba binomial exacta se usa la función <code>binom.test</code> que tiene la siguiente estructura.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="pruebas-de-hipótesis.html#cb82-1"></a><span class="kw">binom.test</span>(x, n, <span class="dt">p =</span> <span class="fl">0.5</span>,</span>
<span id="cb82-2"><a href="pruebas-de-hipótesis.html#cb82-2"></a>           <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;greater&quot;</span>),</span>
<span id="cb82-3"><a href="pruebas-de-hipótesis.html#cb82-3"></a>           <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<p>Los argumentos a definir dentro de <code>binom.test</code> para hacer la prueba son:</p>
<ul>
<li><code>x</code>: número de éxitos en la muestra.</li>
<li><code>n</code>: número de observaciones en la muestra.</li>
<li><code>alternative</code>: tipo de hipótesis alterna. Los valores disponibles son <code>"two.sided"</code> cuando la alterna es <span class="math inline">\(\neq\)</span>, <code>"less"</code> para el caso <span class="math inline">\(&lt;\)</span> y <code>"greater"</code> para <span class="math inline">\(&gt;\)</span>.</li>
<li><code>p</code>: valor de referencia de la prueba.</li>
<li><code>conf.level</code>: nivel de confianza para reportar el intervalo de confianza asociado (opcional).</li>
</ul>
<p>En nuestro ejemplo anterior tendríamos que escribir</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="pruebas-de-hipótesis.html#cb83-1"></a><span class="kw">binom.test</span>(<span class="dt">x=</span><span class="dv">1575</span>, <span class="dt">n=</span><span class="dv">2910</span>, <span class="dt">p=</span><span class="fl">0.55</span>)</span></code></pre></div>
<pre><code>
	Exact binomial test

data:  1575 and 2910
number of successes = 1575, number of trials = 2910, p-value
= 0.3421
alternative hypothesis: true probability of success is not equal to 0.55
95 percent confidence interval:
 0.5229268 0.5594644
sample estimates:
probability of success 
             0.5412371 </code></pre>
<p>Notemos que el p-valor es muy similar al anterior, puesto que estamos con una muestra muy grande.</p>
</div>
</div>
<div id="prueba-de-hipótesis-para-la-razón-de-varianzas-sigma_12-sigma_22" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Prueba de hipótesis para la razón de varianzas <span class="math inline">\(\sigma_1^2 / \sigma_2^2\)</span></h2>
<p>Esta prueba es importante ya que para comparar dos medias (que es el tipo de prubas que más se suele hacer en investigación biomédica) a parte de comprobar que nuestra variable de interés es normal, debemos comprobar que la varianza entre los dos grupos es la misma. O en otras palabras que la razón de la varianza de cada grupo es 1:</p>
<p><span class="math display">\[H_0: \frac{\sigma_{A}^2}{\sigma_{B}^2} = 1\]</span>
<span class="math display">\[H_0: \frac{\sigma_{A}^2}{\sigma_{B}^2} \neq 1\]</span>
Para realizar este tipo de prueba se puede usar la función <code>var.test</code>.</p>
<div id="ejemplo-2" class="section level3 unnumbered" number="">
<h3>Ejemplo</h3>
<p>Supongamos que queremos verificar si la edad de la primera relación sexual (que hemos asumido que es normal) es igual entre casos y controles (variable <code>status</code>). El p-valor correspondiente a esta prueba se calcularía mediante:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="pruebas-de-hipótesis.html#cb85-1"></a><span class="kw">var.test</span>(edad1sex <span class="op">~</span><span class="st"> </span>status, <span class="dt">data=</span>multicentric)</span></code></pre></div>
<pre><code>
	F test to compare two variances

data:  edad1sex by status
F = 0.78849, num df = 1485, denom df = 1402, p-value =
6.426e-06
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.7110839 0.8741965
sample estimates:
ratio of variances 
         0.7884945 </code></pre>
<p>El símbolo <code>~</code> (que se puede escribir con <code>AltGr + 4 y espacio</code>) indica que queremos comparar la varianza de la variable que hay a la izquierda en función de la variable que hay en la derecha. Notemos que hay que indicar a R donde están las variables <code>edad1sex</code> y <code>status</code>, por eso escribimos <code>data=multicentric</code>.</p>
<p>Observamos que el p-valor es &lt;0.05, por lo que tenemos evidencias para decir que la variabilidad de la edad en la primera relación sexual (<code>edad1sex</code>) es distinta entre los casos y los controles. Esto no es un problema desde un punto de vista práctico. Simplemente debemos tenerlo en cuenta a la hora de hacer un test para comparar si esta variable es un factor que se relaciona con tener cáncer o no, tal y como veremos en la siguiente sección.</p>
</div>
</div>
<div id="prueba-de-hipótesis-para-la-igualdad-de-medias-mu_a-mu_b" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Prueba de hipótesis para la igualdad de medias <span class="math inline">\(\mu_A = \mu_B\)</span></h2>
<p>En este caso, estamos interesados en conocer si la media de una variable continua es igual en dos grupos. Para realizar este tipo de prueba se puede usar la función <code>t.test</code> que implementa el test de la t de Student (t-test) y que tiene la siguiente estructura.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="pruebas-de-hipótesis.html#cb87-1"></a><span class="kw">t.test</span>(x, <span class="dt">y =</span> <span class="ot">NULL</span>,</span>
<span id="cb87-2"><a href="pruebas-de-hipótesis.html#cb87-2"></a>       <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;greater&quot;</span>),</span>
<span id="cb87-3"><a href="pruebas-de-hipótesis.html#cb87-3"></a>       <span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">paired =</span> <span class="ot">FALSE</span>, <span class="dt">var.equal =</span> <span class="ot">FALSE</span>,</span>
<span id="cb87-4"><a href="pruebas-de-hipótesis.html#cb87-4"></a>       <span class="dt">conf.level =</span> <span class="fl">0.95</span>, ...)</span></code></pre></div>
<p>Los argumentos a definir dentro de <code>t.test</code> para hacer la prueba son:</p>
<ul>
<li><code>x</code>: vector numérico con la información de la muestra 1,</li>
<li><code>y</code>: vector numérico con la información de la muestra 2,</li>
<li><code>alternative</code>: tipo de hipótesis alterna. Los valores disponibles son <code>"two.sided"</code> cuando la alterna es <span class="math inline">\(\neq\)</span>, <code>"less"</code> para el caso <span class="math inline">\(&lt;\)</span> y <code>"greater"</code> para <span class="math inline">\(&gt;\)</span>.</li>
<li><code>mu</code>: valor de referencia de la prueba (opcinal, no necesario la mayoría de veces ya que siempre queremos comparar si son iguales lo que implica que la diferencia es 0 que es el valor por defecto).</li>
<li><code>var.equal=TRUE</code>: indica que las varianzas son desconocidas pero iguales. Si no lo son, basta con poner <code>var.equal=FALSE</code>.</li>
<li><code>conf.level</code>: nivel de confianza para reportar el intervalo de confianza asociado (opcional).</li>
</ul>
<div id="ejemplo-3" class="section level3 unnumbered" number="">
<h3>Ejemplo</h3>
<p>Siguiendo con el ejemplo anterior, investiguemos si la edad de la primera relación sexual está asociada con tener cáncer cervical. En este caso plantearíamos la prueba estadística:</p>
<p><span class="math display">\[H_0: \mu_\text{controles} =  \mu_\text{casos}\]</span></p>
<p><span class="math display">\[H_1: \mu_\text{controles} \neq \mu_\text{casos}\]</span>
Que puede llevarse a cabo mediante:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="pruebas-de-hipótesis.html#cb88-1"></a><span class="kw">t.test</span>(edad1sex <span class="op">~</span><span class="st"> </span>status, <span class="dt">data=</span>multicentric,</span>
<span id="cb88-2"><a href="pruebas-de-hipótesis.html#cb88-2"></a>       <span class="dt">var.equal=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>
	Welch Two Sample t-test

data:  edad1sex by status
t = -12.073, df = 2800.9, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.420601 -1.744185
sample estimates:
   mean in group Caso mean in group Control 
             18.71803              20.80043 </code></pre>
<p>Notemos que si en la prueba anterior de igualdad de varianzas, no hubiéramos rechazado la hipótesis nula, ahora no sería necesario poner <code>var.equal=FALSE</code> ya que por defecto ese argumento es <code>TRUE</code> que indicaría que las varianzas son iguales. Como en nuestro caso hemos rechazado dicha hipótesis, debemos cambiar este argumento de la función. El resto de la función es similar al caso anterior.</p>
</div>
</div>
<div id="prueba-de-hipótesis-para-la-igualdad-de-más-de-dos-medias-anova" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Prueba de hipótesis para la igualdad de más de dos medias (ANOVA)</h2>
<p>A veces, estamos interesados en comparar la media de nuestra variable de interés para más de dos grupos. En este caso, no podemos usar el t-test anteriormente descrito. La método de análisis de varianza (ANOVA) es el test que se emplea para el estudio del efecto de uno o más factores (cada uno con dos o más niveles) sobre la media de una variable continua. Es por lo tanto el test estadístico a emplear cuando se desea comparar las medias de dos o más grupos.</p>
<p>La prueba estadística puede plantearse como:</p>
<p><span class="math display">\[H_0: \mu_A =  \mu_B = \cdots = \mu_K\]</span></p>
<p><span class="math display">\[H_1: \text{algún par de medias es distinta}\]</span>
Estos análisis podemos llevarlos a cabo con la función <code>aov</code></p>
<div id="ejemplo-4" class="section level3 unnumbered" number="">
<h3>Ejemplo</h3>
<p>Supongamos que queremos averiguar si la edad de la primera relación sexual se asocia con si la mujer es fumadora, no fumadora o ex-fumadora (variable <code>fumar</code>). En este caso, contestaríamos a la pregunta mediante</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="pruebas-de-hipótesis.html#cb90-1"></a>mod &lt;-<span class="st"> </span><span class="kw">aov</span>(edad1sex <span class="op">~</span><span class="st"> </span>fumar, <span class="dt">data=</span>multicentric)</span>
<span id="cb90-2"><a href="pruebas-de-hipótesis.html#cb90-2"></a><span class="kw">summary</span>(mod)</span></code></pre></div>
<pre><code>              Df Sum Sq Mean Sq F value Pr(&gt;F)    
fumar          2    688   343.9   15.51  2e-07 ***
Residuals   2886  64004    22.2                   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
21 observations deleted due to missingness</code></pre>
<p>Puesto que el p-valor asociado a esta prueba es &lt;0.05, concluiríamos que nuestros datos aportan evidencias para rechazar la hipótesis nula. Por lo tanto, la media de la primera relación sexual es distinta para alguno de los grupos que estamos comparando.</p>
<p>Ahora tendríamos que decir entre qué grupos hay diferencias, y para ello, usaríamos lo que se conoce como post-hoc tests. Existen numerosos tests en la literatura para hacer estas comparaciones a posteriori cuando hemos rechazado la hipótesis nula en un ANOVA. Nosotros usaremos <code>TukeyHSD</code> que es sencilla de usar, es uno de los métodos más robustos y no requiere ninguna otra libería. Basta con ejecutar la función sobre el objeto anterior que contiene el ANOVA</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="pruebas-de-hipótesis.html#cb92-1"></a><span class="kw">TukeyHSD</span>(mod)</span></code></pre></div>
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = edad1sex ~ fumar, data = multicentric)

$fumar
                           diff        lwr      upr     p adj
fumador-ex-fumador    -0.381524 -1.3665451 0.603497 0.6351209
no fumador-ex-fumador  1.046651  0.2732668 1.820036 0.0043414
no fumador-fumador     1.428176  0.7391876 2.117163 0.0000037</code></pre>
<p>Este test nos diría que hay diferencias entre los grupos de no fumadoras y las exfumadoras y fumadoras. Notemos que el resultado de los análisis muestra <code>p adj</code> que indica que es un p-valor ajustado ya que estamos haciendo muchas comparaciones estadísticas (tres) con los mismos datos y necesitamos tener esto en cuenta para tener un valor de significación global del 5%.</p>
</div>
</div>
<div id="prueba-de-hipótesis-para-la-igualdad-de-proporciones-p_a-p_b" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Prueba de hipótesis para la igualdad de proporciones <span class="math inline">\(p_A = p_B\)</span></h2>
<p>Para realizar pruebas de hipótesis para comparar dos proporciones se usa la función <code>chisq.test</code>.</p>
<div id="ejemplo-5" class="section level3 unnumbered" number="">
<h3>Ejemplo</h3>
<p>Supongamos que queremos investigar si dar positivo en el test del virus de papiloma humano (variable <code>vph</code>) es un factor de riesgo para desarrollar cáncer cervical. La hipótesis que se planteraria sería:</p>
<p><span class="math display">\[H_0: p_{\text{controles}}  = p_{\text{casos}}\]</span></p>
<p><span class="math display">\[H_0: p_{\text{controles}}  \neq p_{\text{casos}}\]</span></p>
<p>En este caso, variable de interés es categórica (binaria) y la queremos comparar entre dos grupos. En ese caso necesitamos usar un test de Chi-cuadrado que se calcula a partir de la tabla de contingencia que recordemos del capítulo anterior que se puede obtener de la siguiente forma con la librería <code>summarytools</code>:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="pruebas-de-hipótesis.html#cb94-1"></a><span class="kw">library</span>(summarytools)</span>
<span id="cb94-2"><a href="pruebas-de-hipótesis.html#cb94-2"></a><span class="kw">ctable</span>(multicentric<span class="op">$</span>vph, multicentric<span class="op">$</span>status, </span>
<span id="cb94-3"><a href="pruebas-de-hipótesis.html#cb94-3"></a>        <span class="dt">useNA=</span><span class="st">&quot;no&quot;</span>, <span class="dt">prop=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<pre><code>Cross-Tabulation, Column Proportions  
vph * status  
Data Frame: multicentric  

---------- -------- --------------- --------------- ---------------
             status            Caso         Control           Total
       vph                                                         
  negativo              81 (  6.4%)    996 ( 85.6%)   1077 ( 44.2%)
  positivo            1190 ( 93.6%)    168 ( 14.4%)   1358 ( 55.8%)
     Total            1271 (100.0%)   1164 (100.0%)   2435 (100.0%)
---------- -------- --------------- --------------- ---------------</code></pre>
<p>Vemos que la proporción de casos que dan positivo en la prueba es del 93.6%, mientras que en los controles es de tan sólo el 14.4%. Esto parece indicar que ambas variables están relacionadas, o en otras palabras, que dar positivo por este virus es un factor de riesgo para el cáncer cervical. Pero, como siempre, a estas diferencias le tenemos quedar un valor de significación estadística que podemos obtener de dos formas. Una poniendo el argumento <code>chisq=TRUE</code> en la función anterior</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="pruebas-de-hipótesis.html#cb96-1"></a><span class="kw">ctable</span>(multicentric<span class="op">$</span>vph, multicentric<span class="op">$</span>status, </span>
<span id="cb96-2"><a href="pruebas-de-hipótesis.html#cb96-2"></a>        <span class="dt">useNA=</span><span class="st">&quot;no&quot;</span>, <span class="dt">prop=</span><span class="st">&quot;c&quot;</span>, <span class="dt">chisq=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>Cross-Tabulation, Column Proportions  
vph * status  
Data Frame: multicentric  


---------- -------- --------------- --------------- ---------------
             status            Caso         Control           Total
       vph                                                         
  negativo              81 (  6.4%)    996 ( 85.6%)   1077 ( 44.2%)
  positivo            1190 ( 93.6%)    168 ( 14.4%)   1358 ( 55.8%)
     Total            1271 (100.0%)   1164 (100.0%)   2435 (100.0%)
---------- -------- --------------- --------------- ---------------

----------------------------
 Chi.squared   df   p.value 
------------- ---- ---------
    1542       1       0    
----------------------------</code></pre>
<p>y otra, usando la función <code>chisq.test</code>, pero que no devuelve la tabla ni los porcentajes.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="pruebas-de-hipótesis.html#cb98-1"></a><span class="kw">chisq.test</span>(multicentric<span class="op">$</span>vph, multicentric<span class="op">$</span>status)</span></code></pre></div>
<pre><code>
	Pearson&#39;s Chi-squared test with Yates&#39; continuity correction

data:  multicentric$vph and multicentric$status
X-squared = 1541.6, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>Vemos que en ambos casos obtenemos el mismo resultado, que no es otro que tenemos suficientes evidencias en nuestros datos para rechazar la hipótesis de igualdad de proporciones ya que el p-valor es menor que 0.05, por lo que la proporción de infectadas en casos es distinta que en controles (mayor) o lo que es lo mismo, que esta variable es un factor de riesgo para el cáncer cervical.</p>
</div>
</div>
<div id="pruebas-no-paramétricas" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Pruebas no paramétricas</h2>
<p>En el ejemplo de la variable edad de la primera relación sexual, hemos visto que no sigue una distribución normal, por lo que los métodos anteriormente descrito no serían válidos. En realidad, no es que no lo sean, si no que no son los más potentes para encontrar diferencias cuando realmente las hay. Esto iría en contra nuestra como investigadores. Es por ello que, en estos casos, se recomienda usar tests no paramétricos que no suponen ninguna distribución para los datos.</p>
<p>La alternativa al t-test es el test de Mann–Whitney–Wilcoxon, también conocido como test de la suma de rangos de Wilcoxon. Es un test no paramétrico que contrasta si dos muestras proceden de poblaciones equidistribuidas.</p>
<p>Como nuestra variable <code>edad1sex</code> no seguía una distribución normal, lo ideal hubiera sido utilizar un test no paramétrico.</p>
<p>Para la prueba</p>
<p><span class="math display">\[H_0: \mu =18\]</span></p>
<p>usaríamos</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="pruebas-de-hipótesis.html#cb100-1"></a><span class="kw">wilcox.test</span>(multicentric<span class="op">$</span>edad1sex, <span class="dt">mu=</span><span class="dv">18</span>)</span></code></pre></div>
<pre><code>
	Wilcoxon signed rank test with continuity correction

data:  multicentric$edad1sex
V = 2240843, p-value &lt; 2.2e-16
alternative hypothesis: true location is not equal to 18</code></pre>
<p>y para la prueba</p>
<p><span class="math display">\[H_0: \mu_\text{controles} =  \mu_\text{casos}\]</span></p>
<p>sería</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="pruebas-de-hipótesis.html#cb102-1"></a><span class="kw">wilcox.test</span>(edad1sex<span class="op">~</span>status, <span class="dt">data=</span>multicentric)</span></code></pre></div>
<pre><code>
	Wilcoxon rank sum test with continuity correction

data:  edad1sex by status
W = 760404, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>Y en ambos casos obtendríamos la misma conclusión que con un test paramétrico.</p>
<p>Para el caso de un test de ANOVA, que también requiere normalidad, deberíamos usar el test de Kruskall-Wallis que se calcula así:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="pruebas-de-hipótesis.html#cb104-1"></a><span class="kw">kruskal.test</span>(edad1sex<span class="op">~</span>fumar, <span class="dt">data=</span>multicentric)</span></code></pre></div>
<pre><code>
	Kruskal-Wallis rank sum test

data:  edad1sex by fumar
Kruskal-Wallis chi-squared = 31.373, df = 2, p-value =
1.54e-07</code></pre>
<p>Al igual que con ANOVA, debemos realizar tests a posteriori para ver entre qué grupos hay differencias. Para el caso no paramétrico, esto lo podemos hacer con el test de Nemenyi que está implementado en la librería <code>DescTools</code> que primero debemos instalar con la instrucción <code>install.packages("DescTools")</code>. Al igual que en el caso del ANOVA, usaremos el método propuesto por Tukey. La instrucción es la siguiente. Notemos que la variable grupal (argumento <code>g</code>) debe ser factor, por eso usamos la función <code>as.factor()</code>:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="pruebas-de-hipótesis.html#cb106-1"></a><span class="kw">library</span>(DescTools)</span>
<span id="cb106-2"><a href="pruebas-de-hipótesis.html#cb106-2"></a>pvals &lt;-<span class="st"> </span><span class="kw">NemenyiTest</span>(<span class="dt">x =</span> multicentric<span class="op">$</span>edad1sex,</span>
<span id="cb106-3"><a href="pruebas-de-hipótesis.html#cb106-3"></a>                     <span class="dt">g =</span> <span class="kw">as.factor</span>(multicentric<span class="op">$</span>fumar), <span class="dt">dist=</span><span class="st">&quot;tukey&quot;</span>)</span>
<span id="cb106-4"><a href="pruebas-de-hipótesis.html#cb106-4"></a>pvals</span></code></pre></div>
<pre><code>
 Nemenyi&#39;s test of multiple comparisons for independent samples (tukey)  

                      mean.rank.diff   pval    
fumador-ex-fumador         -70.27367 0.6121    
no fumador-ex-fumador      184.23356 0.0046 ** 
no fumador-fumador         254.50724  3e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>De nuevo obtendríamos un valor similar al test paramétrico. Esto ocurre porque tenemos una base de datos con muchos casos, y los test paramétricos suelen funcionar bien. <strong>IMPORANTE:</strong> Los test no paramétricos muestras su mejor potencia cuando las bases de datos son pequeñas.</p>
<p>Finalmente, el test de Chi-cuadrado que hemos calculado para testar</p>
<p><span class="math display">\[H_0: p_{\text{controles}}  = p_{\text{casos}}\]</span></p>
<p>también tiene su versión no paramétrica en el test de Fisher. Este test es necesario no sólo cuando hay poco tamaño muestral, si no que también cuando hay pocos casos en algunas de las celdas de la tabla de contingencia. Este test podríamos calcularlo con esta función:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="pruebas-de-hipótesis.html#cb108-1"></a><span class="kw">fisher.test</span>(multicentric<span class="op">$</span>vph, multicentric<span class="op">$</span>status)</span></code></pre></div>
<pre><code>
	Fisher&#39;s Exact Test for Count Data

data:  multicentric$vph and multicentric$status
p-value &lt; 2.2e-16
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.008625214 0.015318378
sample estimates:
odds ratio 
0.01152201 </code></pre>
<p>que al igual que en los casos anteriores, llegamos a la misma conclusión que con un test paramétrico.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estadística-descriptiva.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelos-de-regresión.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/isglobal-brge/Aprendizaje_Automatico_1/tree/master/docs04-pruebas_hipotesis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
